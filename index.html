<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>CampusCloud Canvas Editor</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
		<link rel="icon" href="favicon.ico" />
		<link href="assets/common.css" rel="stylesheet" />
		<link href="assets/editor.css" rel="stylesheet" />
		<script src="core/dist/index.umd.js" rel="script"></script>
		<script src="editor/dist/index.umd.js" rel="script"></script>

		<style>
			:root {
				--mce-bg: #252525;
				--mce-panel-bg: #474747;
				--mce-panel-border: #3d3d3d;
				--mce-panel-light: #5d5d5d;
				--mce-panel-hover: #6366f1;
				--mce-panel-active: #eef2ff;
				--mce-panel-border-light: #e0e7ef;
				--mce-text: #d4d4d4;
				--mce-text-dark: #2a2a2a;
				--mce-text-muted: #6b7280;
				--mce-accent: #6366f1;
			}
			.welcome-modal {
				position: fixed;
				top: 0; left: 0; right: 0; bottom: 0;
				background: rgba(37,37,37,0.85);
				display: flex;
				align-items: center;
				justify-content: center;
				z-index: 10000;
				font-family: inherit;
			}
			.welcome-content {
				background: var(--mce-panel-bg);
				border-radius: 12px;
				padding: 36px 44px 28px 44px;
				min-width: 320px;
				width: 90vw;
				max-width: 900px;
				max-height: 90vh;
				overflow-y: auto;
				box-shadow: 0 8px 32px rgba(0,0,0,0.18);
				display: flex;
				flex-direction: column;
				gap: 28px;
				border: 1.5px solid var(--mce-panel-border);
				color: var(--mce-text);
			}
			.welcome-title {
				font-size: 2.4rem;
				font-weight: 800;
				margin-bottom: 16px;
				color: var(--mce-text);
				letter-spacing: -1.5px;
				text-align: center;
				background: linear-gradient(135deg, var(--mce-accent), #8b5cf6);
				-webkit-background-clip: text;
				-webkit-text-fill-color: transparent;
				background-clip: text;
				text-shadow: 0 2px 4px rgba(0,0,0,0.1);
				position: relative;
				word-wrap: break-word;
				overflow-wrap: break-word;
				hyphens: auto;
				line-height: 1.2;
			}
			.welcome-title::after {
				content: '';
				position: absolute;
				bottom: -8px;
				left: 50%;
				transform: translateX(-50%);
				width: 60px;
				height: 3px;
				background: linear-gradient(135deg, var(--mce-accent), #8b5cf6);
				border-radius: 2px;
			}
			.welcome-section {
				margin-bottom: 10px;
			}
			.welcome-section strong {
				color: var(--mce-text);
				font-size: 1.08rem;
				font-weight: 600;
			}
			.welcome-layouts, .welcome-templates {
				display: flex;
				gap: 18px;
				flex-wrap: wrap;
				margin-top: 8px;
			}
			.welcome-recents {
				display: flex;
				gap: 18px;
				margin-top: 8px;
				overflow-x: auto;
				overflow-y: hidden;
				padding-bottom: 8px;
				scrollbar-width: thin;
				scrollbar-color: var(--mce-accent) var(--mce-panel-border);
			}
			.welcome-recents::-webkit-scrollbar {
				height: 8px;
			}
			.welcome-recents::-webkit-scrollbar-track {
				background: var(--mce-panel-border);
				border-radius: 4px;
			}
			.welcome-recents::-webkit-scrollbar-thumb {
				background: var(--mce-accent);
				border-radius: 4px;
			}
			.welcome-recents::-webkit-scrollbar-thumb:hover {
				background: #4f46e5;
			}
			.welcome-recents-container {
				position: relative;
				overflow: hidden;
			}
			.welcome-recents-container::after {
				content: '';
				position: absolute;
				top: 0;
				right: 0;
				width: 20px;
				height: calc(100% - 8px);
				background: linear-gradient(to left, var(--mce-panel-bg), transparent);
				pointer-events: none;
				opacity: 0;
				transition: opacity 0.3s;
			}
			.welcome-recents-container.has-overflow::after {
				opacity: 1;
			}
			.welcome-layout, .welcome-template, .welcome-recent {
				background: var(--mce-bg);
				border-radius: 8px;
				padding: 14px 18px 12px 18px;
				cursor: pointer;
				min-width: 120px;
				text-align: center;
				transition: background 0.18s, box-shadow 0.18s, border 0.18s;
				border: 1.5px solid var(--mce-panel-border);
				box-shadow: 0 1px 4px rgba(0,0,0,0.04);
				position: relative;
				display: flex;
				flex-direction: column;
				align-items: center;
				color: var(--mce-text);
			}
			.welcome-layout.selected, .welcome-template.selected {
				border: 2px solid var(--mce-accent);
				background: var(--mce-panel-active);
				color: var(--mce-text-dark);
			}
			.welcome-layout:hover, .welcome-template:hover, .welcome-recent:hover {
				background: var(--mce-panel-light);
				border-color: var(--mce-accent);
			}
			.welcome-template img, .welcome-recent img {
				width: 64px;
				height: 64px;
				object-fit: contain;
				border-radius: 6px;
				margin-bottom: 6px;
				background: var(--mce-panel-bg);
				border: 1px solid var(--mce-panel-border-light);
			}
			.welcome-template-label, .welcome-layout-label {
				font-size: 1.01rem;
				font-weight: 500;
				color: var(--mce-text);
			}
			.welcome-layout.selected .welcome-layout-label,
			.welcome-template.selected .welcome-template-label {
				color: var(--mce-accent);
			}
			.welcome-layout-desc {
				font-size: 0.92rem;
				color: var(--mce-text-muted);
				margin-top: 2px;
			}
			.welcome-close {
				align-self: flex-end;
				background: none;
				border: none;
				font-size: 1.5rem;
				cursor: pointer;
				color: var(--mce-text-muted);
				margin-bottom: -18px;
				margin-right: -10px;
				transition: color 0.15s;
			}
			.welcome-close:hover {
				color: var(--mce-accent);
			}
			.welcome-custom-fields {
				display: flex;
				gap: 8px;
				margin-top: 8px;
				align-items: center;
			}
			.welcome-custom-fields label {
				color: var(--mce-text);
			}
			.welcome-custom-fields input {
				width: 70px;
				padding: 4px 6px;
				border: 1px solid var(--mce-panel-border-light);
				border-radius: 4px;
				font-size: 1rem;
				background: var(--mce-bg);
				color: var(--mce-text);
			}
			.welcome-custom-fields input:focus {
				outline: 1.5px solid var(--mce-accent);
			}
			.welcome-custom-fields button {
				background: var(--mce-accent);
				color: #fff;
				border: none;
				border-radius: 4px;
				padding: 6px 16px;
				font-size: 1rem;
				cursor: pointer;
				transition: background 0.15s;
			}
			.welcome-custom-fields button:hover {
				background: #4f46e5;
			}
			.welcome-recent {
				min-width: 180px;
				width: 180px;
				min-height: 80px;
				flex-direction: row;
				align-items: center;
				gap: 10px;
				padding: 10px 16px;
				background: var(--mce-bg);
				border: 1.5px solid var(--mce-panel-border);
				color: var(--mce-text);
				flex-shrink: 0;
			}
			.welcome-recent .recent-info {
				display: flex;
				flex-direction: column;
				align-items: flex-start;
			}
			.welcome-recent .recent-title {
				font-size: 1.01rem;
				font-weight: 500;
				color: var(--mce-text);
			}
			.welcome-recent .recent-date {
				font-size: 0.89rem;
				color: var(--mce-text-muted);
			}
			.recent-delete {
				position: absolute;
				top: 4px;
				right: 4px;
				background: rgba(220, 38, 38, 0.8);
				color: white;
				border: none;
				border-radius: 50%;
				width: 20px;
				height: 20px;
				font-size: 14px;
				line-height: 1;
				cursor: pointer;
				display: none;
				align-items: center;
				justify-content: center;
				transition: all 0.15s;
			}
			.welcome-recent:hover .recent-delete {
				display: flex;
			}
			.recent-delete:hover {
				background: rgba(220, 38, 38, 1);
				transform: scale(1.1);
			}
			
			/* Mobile Responsive Styles */
			@media (max-width: 768px) {
				.welcome-content {
					padding: 24px 20px 20px 20px;
					gap: 20px;
					width: 95vw;
					min-width: 280px;
					max-height: 85vh;
				}
				
				.welcome-title {
					font-size: 1.8rem;
					letter-spacing: -1px;
					margin-bottom: 12px;
				}
				
				.welcome-title::after {
					width: 40px;
					height: 2px;
					bottom: -6px;
				}
				
				.welcome-section {
					margin-bottom: 8px;
				}
				
				.welcome-section strong {
					font-size: 1rem;
				}
				
				.welcome-layouts, .welcome-templates {
					gap: 12px;
					justify-content: center;
				}
				
				.welcome-layout, .welcome-template {
					min-width: 100px;
					padding: 12px 14px 10px 14px;
				}
				
				.welcome-layout-label, .welcome-template-label {
					font-size: 0.9rem;
				}
				
				.welcome-layout-desc {
					font-size: 0.8rem;
				}
				
				.welcome-recents-container {
					max-width: 100%;
				}
				
				.welcome-recent {
					min-width: 150px;
					width: 150px;
					padding: 8px 12px;
					gap: 8px;
				}
				
				.welcome-recent img, .welcome-recent > div:first-child {
					width: 48px !important;
					height: 48px !important;
					font-size: 18px !important;
				}
				
				.welcome-recent .recent-title {
					font-size: 0.9rem;
				}
				
				.welcome-recent .recent-date {
					font-size: 0.8rem;
				}
				
				.recent-delete {
					width: 18px;
					height: 18px;
					font-size: 12px;
					top: 2px;
					right: 2px;
				}
				
				.welcome-custom-fields {
					flex-direction: column;
					align-items: flex-start;
					gap: 12px;
				}
				
				.welcome-custom-fields label {
					display: flex;
					align-items: center;
					gap: 8px;
					width: 100%;
				}
				
				.welcome-custom-fields input {
					width: 80px;
				}
				
				.welcome-custom-fields button {
					align-self: stretch;
					margin-left: 0 !important;
				}
			}
			
			@media (max-width: 480px) {
				.welcome-content {
					padding: 20px 16px 16px 16px;
					gap: 16px;
					width: 98vw;
					min-width: 260px;
				}
				
				.welcome-title {
					font-size: 1.6rem;
					letter-spacing: -0.5px;
				}
				
				.welcome-layouts, .welcome-templates {
					gap: 8px;
				}
				
				.welcome-layout, .welcome-template {
					min-width: 80px;
					padding: 10px 12px 8px 12px;
				}
				
				.welcome-layout-label, .welcome-template-label {
					font-size: 0.85rem;
				}
				
				.welcome-layout-desc {
					font-size: 0.75rem;
				}
				
				.welcome-recent {
					min-width: 130px;
					width: 130px;
					padding: 6px 10px;
				}
				
				.welcome-recent img, .welcome-recent > div:first-child {
					width: 40px !important;
					height: 40px !important;
					font-size: 16px !important;
				}
				
				.welcome-recent .recent-title {
					font-size: 0.85rem;
				}
				
				.welcome-recent .recent-date {
					font-size: 0.75rem;
				}
			}
		</style>
	</head>
	<body>
		<header class="header bb">
			<img src="assets/circle-logo.png" class="app-icon" alt="app icon">
			<nav class="top-menu">
				<div class="top-menu-item" id="file-menu">File
					<div class="top-menu-dropdown">
						<button id="menu-new" class="top-menu-action">New Project</button>
						<button id="menu-open" class="top-menu-action">Open Image...</button>
						<button id="menu-save" class="top-menu-action">Export as PNG</button>
						<button id="menu-export" class="top-menu-action">Save Project</button>
						<button id="menu-import" class="top-menu-action">Load Project...</button>
						<div class="top-menu-separator"></div>
						<button id="menu-save-state" class="top-menu-action">● Save to Browser</button>
						<button id="menu-clear-state" class="top-menu-action">✕ Clear Browser Data</button>
					</div>
				</div>
				<div class="top-menu-sep"></div>
				<button id="menu-undo" class="top-menu-action small">Undo</button>
				<button id="menu-redo" class="top-menu-action small">Redo</button>
			</nav>
			<div class="header-title">
				<h1>📦 CampusCloud Canvas Editor</h1>
			</div>
			<div class="header-links">
				<a href="https://campuscloud.co.zw" target="_blank">CampusCloud</a>
			</div>
		</header>

		<div id="canvas"></div>

		<!-- Welcome Modal -->
		<div id="welcome-modal" class="welcome-modal" style="display:none;">
			<div class="welcome-content">
				<button class="welcome-close" id="welcome-close-btn" title="Close">&times;</button>
				<div class="welcome-title">Welcome to CampusCloud Canvas Editor</div>
				<div class="welcome-section">
					<strong>Choose a Layout:</strong>
					<div class="welcome-layouts">
						<div class="welcome-layout" data-layout="avatar">
							<div class="welcome-layout-label">Avatar</div>
							<div class="welcome-layout-desc">120×120px</div>
						</div>
						<div class="welcome-layout" data-layout="thumbnail">
							<div class="welcome-layout-label">Thumbnail</div>
							<div class="welcome-layout-desc">120×120px</div>
						</div>
						<div class="welcome-layout" data-layout="profile-cover">
							<div class="welcome-layout-label">Profile Cover</div>
							<div class="welcome-layout-desc">1200×500px</div>
						</div>
						<div class="welcome-layout" data-layout="preview-image">
							<div class="welcome-layout-label">Preview Image</div>
							<div class="welcome-layout-desc">1200×610px</div>
						</div>
						<div class="welcome-layout" data-layout="custom">
							<div class="welcome-layout-label">Custom...</div>
							<div class="welcome-layout-desc">Set your own size</div>
						</div>
					</div>
					<div class="welcome-custom-fields" id="custom-fields" style="display:none;">
						<label>Width <input type="number" id="custom-width" min="1" max="10000" value="1200"> px</label>
						<label>Height <input type="number" id="custom-height" min="1" max="10000" value="610"> px</label>
						<button id="custom-apply" style="margin-left:8px;">Apply</button>
					</div>
				</div>
				<div class="welcome-section">
					<strong>Templates:</strong>
					<div class="welcome-templates">
						<div class="welcome-template" data-template="blank">
							<img src="assets/blank.png" alt="Blank Template">
							<div class="welcome-template-label">Blank</div>
						</div>
						<div class="welcome-template" data-template="landing-hero-1">
							<img src="assets/landing-hero-1.png" alt="Landing Hero 1">
							<div class="welcome-template-label">Landing Hero 1</div>
						</div>
						<div class="welcome-template" data-template="landing-hero-2">
							<img src="assets/landing-hero-2.png" alt="Landing Hero 2">
							<div class="welcome-template-label">Landing Hero 2</div>
						</div>
						<div class="welcome-template" data-template="browse" style="background:var(--mce-panel-light);color:var(--mce-accent);">
							<svg width="32" height="32" viewBox="0 0 24 24" fill="none" style="margin-bottom:6px;"><path d="M12 16v-4m0 0V8m0 4h4m-4 0H8m12 4v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><rect x="3" y="4" width="18" height="12" rx="2" stroke="currentColor" stroke-width="2"/></svg>
							<div class="welcome-template-label">Browse...</div>
						</div>
					</div>
				</div>

				<div class="welcome-section">
					<strong>Recent Projects:</strong>
					<div class="welcome-recents-container">
					<div class="welcome-recents" id="welcome-recents">
						<div class="welcome-recent">No recent projects</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Status Bar -->
		<div id="status-bar" class="status-bar">
			<div class="status-section">
				<span id="status-persistence" class="status-item">
					<span class="status-icon">
						<svg viewBox="0 -960 960 960">
							<path d="M840-680v480q0 33-23.5 56.5T760-120H200q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h480l160 160Zm-80 34L646-760H200v560h560v-446ZM480-240q50 0 85-35t35-85q0-50-35-85t-85-35q-50 0-85 35t-35 85q0 50 35 85t85 35ZM240-560h360v-160H240v160Zm-40-86v446-560 114Z"/>
						</svg>
					</span>
					<span class="status-text">Auto-save: Off</span>
				</span>
			</div>
			<div class="status-section">
				<span id="status-canvas-size" class="status-item">
					<span class="status-icon">
						<svg viewBox="0 -960 960 960">
							<path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0 0v-560 560Z"/>
						</svg>
					</span>
					<span class="status-text">1200 × 610</span>
				</span>
			</div>
			<div class="status-section">
				<span id="status-zoom" class="status-item">
					<span class="status-icon">
						<svg viewBox="0 -960 960 960">
							<path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/>
						</svg>
					</span>
					<span class="status-text">100%</span>
				</span>
			</div>
			<div class="status-section">
				<span id="status-objects" class="status-item">
					<span class="status-icon">
						<svg viewBox="0 -960 960 960">
							<path d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"/>
						</svg>
					</span>
					<span class="status-text">0 objects</span>
				</span>
			</div>
			<div class="status-section">
				<span id="status-selection" class="status-item">
					<span class="status-icon">
						<svg viewBox="0 -960 960 960">
							<path d="m320-410 79-110h170L320-716v306ZM551-80 406-392 240-160v-720l560 440H516l144 309-109 51ZM399-520Z"/>
						</svg>
					</span>
					<span class="status-text">None selected</span>
				</span>
			</div>
			<div class="status-section status-right">
				<span id="status-last-save" class="status-item">
					<span class="status-icon">
						<svg viewBox="0 -960 960 960">
							<path d="m612-292 56-56-148-148v-184h-80v216l172 172ZM480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z"/>
						</svg>
					</span>
					<span class="status-text">Never saved</span>
				</span>
			</div>
			<!-- Status message overlay -->
			<div id="status-message" class="status-message" style="opacity: 0;"></div>
		</div>

		<!-- Loading Overlay -->
		<div id="loading-overlay" class="loading-overlay">
			<div class="loading-content">
				<div class="loading-spinner"></div>
				<p class="loading-text">Loading project...</p>
			</div>
		</div>

				<script src="app.js"></script>
	</body>
</html>
